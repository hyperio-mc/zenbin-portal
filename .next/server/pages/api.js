"use strict";(()=>{var e={};e.id=237,e.ids=[237],e.modules={1323:(e,r)=>{Object.defineProperty(r,"l",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},5703:(e,r,t)=>{t.r(r),t.d(r,{config:()=>d,default:()=>p,routeModule:()=>c});var n={};t.r(n),t.d(n,{default:()=>l});var i=t(3105),s=t(5244),o=t(1323);let a=new Map,u=new Map;async function l(e,r){let{method:n,url:i}=e;if("POST"===n&&"/api/auth/token"===i){let{apiKey:n}=e.body;if(!n)return r.status(400).json({error:"API key required"});let i=u.get(n);if(!i)return r.status(401).json({error:"Invalid API key"});let s=null;for(let e of a.values())if(e.id===i){s=e;break}if(!s)return r.status(401).json({error:"User not found"});let{generateApiToken:o}=t(8263),l=o(s);return r.json({access_token:l,token_type:"Bearer",expires_in:86400})}if("POST"===n&&"/api/signup"===i){let{email:n,password:i}=e.body;if(!n||!i)return r.status(400).json({error:"Email and password required"});if(a.has(n))return r.status(400).json({error:"Email already exists"});let s=t(8432),{generateApiKey:o}=t(8263),{PLANS:l}=t(8142),p=await s.hash(i,10),d=o(),c={id:`user_${Date.now()}`,email:n,password:p,plan:"free",monthlyRequests:l.free.monthlyRequests,createdAt:new Date().toISOString()};return a.set(n,c),u.set(d,c.id),r.status(201).json({user:{id:c.id,email:c.email,plan:c.plan},apiKey:d})}if("POST"===n&&"/api/auth/login"===i){let{email:n,password:i}=e.body,s=a.get(n);if(!s)return r.status(401).json({error:"Invalid credentials"});let o=t(8432);if(!await o.compare(i,s.password))return r.status(401).json({error:"Invalid credentials"});let{generateApiToken:l}=t(8263),p=l(s);return r.json({user:{id:s.id,email:s.email,plan:s.plan},apiKey:Array.from(u.entries()).filter(([e,r])=>r===s.id).map(([e])=>e)[0]||null,access_token:p,token_type:"Bearer",expires_in:86400})}r.status(404).json({error:"Not found"})}let p=(0,o.l)(n,"default"),d=(0,o.l)(n,"config"),c=new i.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api",pathname:"/api",bundlePath:"",filename:""},userland:n})},8142:e=>{let r=process.env.ZENBIN_JWT_SECRET||"change-me-in-production";e.exports={ZENBIN_JWT_SECRET:r,PLANS:{free:{name:"Free",priceId:null,monthlyRequests:10,monthlyPrice:0},hobby:{name:"Hobby",priceId:"price_hobby_001",monthlyRequests:1e3,monthlyPrice:5},pro:{name:"Pro",priceId:"price_pro_001",monthlyRequests:1e4,monthlyPrice:15},business:{name:"Business",priceId:"price_business_001",monthlyRequests:1e5,monthlyPrice:49}}}},8263:(e,r,t)=>{let n=t(9344),{ZENBIN_JWT_SECRET:i}=t(8142);e.exports={generateApiToken:function(e){let r={sub:e.id,email:e.email,plan:e.plan,monthlyRequests:e.monthlyRequests,apiKeyId:e.apiKeyId};return n.sign(r,i,{expiresIn:"24h"})},generateApiKey:function(){let e=t(4770).randomBytes(16).toString("hex");return`zb_live_${e}`},verifyApiToken:function(e){try{return n.verify(e,i)}catch(e){return null}}}},5244:(e,r)=>{var t;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))},3105:(e,r,t)=>{e.exports=t(145)},8432:e=>{e.exports=require("bcryptjs")},9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},4770:e=>{e.exports=require("crypto")}};var r=require("../webpack-runtime.js");r.C(e);var t=r(r.s=5703);module.exports=t})();